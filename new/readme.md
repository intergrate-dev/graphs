# 1

## 2

### 业务流程

### 问题

p14 权限维护具体包括哪些？
p13 接入方动态接入，参与方为每个接入方提供单独的数据合约。假如某个提供方有3个目录，每个目录又有多个不同的接入方，那么会有多少个智能合约？
权限合约的 数据归属信息是怎样的？ 

第9页 接口获取数据
使用方请求查询数据，接口中获取它的成员信息，取得数据资源归属的单位（提供方目录）？，获取数据资源的访问权限？


p13 接入方动态接入，参与方为每个接入方提供单独的数据合约。
权限合约：访问权限列表（目录(1)--接入方(N)）

### 数据上链

#### 前置库上链

从前置机库拉定时批量取数据，由目录归属单位（提供方）调用（多份）智能合约上链。通过目录管理由数据信息知道对应目录，[成员管理]再由目录知道提供方，以及目录对应的多个接入方，也就知道所对应的（多份）智能合约地址(公钥（1）--地址（N）)。
（提供方成员用户对应着前置机）
（关系： {提供方：目录：接入方}，两层映射。假如某个提供方有3个目录，每个目录又有多个不同的接入方，会有多少个智能合约？）  

##### 逻辑----数据交换与上链

提供方：目录注册上链，并创建交换任务。
使用方：查询，订阅了哪些提供方的目录，分别调用对应合约。汇总分页。
交换任务：任务扫描，从前置机拉取资源（对应目录），调用合约上链。

##### 逻辑----总体流程

p11
管理方：注册参与方，接受授予请求将用户注册为成员，调用成员合约。
提供方：注册用户，请求授予参与方身份（？），成员用户编目目录（具体？），目录信息上链，数据资源上链(?)，目录授权（如何授权，7和8的关系，）
使用方：注册用户，查询目录列表（按什么条件去查，成员用户才能查？），申请数据访问权限（调用目录管理合约，7），查询数据访问信息（调用目录管理的合约，调用授权合约，指的是8？），查询链上数据（数据资源，调用授权合约，指的是7？）

[授权管理：如何授权，]
[权限合约：访问权限列表（提供方--目录--使用方？），数据归属信息（目录--数据？），具体是怎么管理的？]

#### 接口上链

局办上传数据文件（或者单条数据）到中心，调用该局办智能合约将数据上链（一个局办用户可能对应多份智能合约，权限：智能合约对应的使用方是否有权限）。
获取请求方（提供方）身份，调用成员管理，再调用智能合约。（不知道是哪个目录，也不知道调用哪些智能合约）

#### 界面提交数据上链

仅上传文件，流程如上

### 数据获取

#### 接口获取

由使用方身份获取成员，取得数据资源归属的单位（提供方目录）？，获取数据资源的访问权限？，

#### 界面获取

界面支持简单查询，流程如上，智能合约的分页实现？


#### 模块

交换管理 成员管理，部分上链，部分入库。




### 模块梳理

#### 成员管理

功能：为用户分配参与方账户（用户）

关键信息：
参与方（提供方/使用方）， 公私钥

#### 目录管理

功能：为提供方用户创建些目录，并生成交换任务（仅针对平台），

目录--关键信息：
共享类型：不共享，有/无条件共享
更新周期：交换频率
所属成员：提供方
目录类型（结构化/文件）， 上链方式：平台自取（前置机定时任务）/接口/界面上传文件

**** 平台对应的连接库信息

数据项信息：用于文件方式的交换（界面上传）

*** 特别说明：
平台自取方式----从前置库上链；
接口方式----直接上链
界面文件上传----上传 > 后续处理, 

*** 智能合约信息与部署（多模块通用），部署完的结果（合约地址）管理？

上链问题：信息不会全上链吧？
上链原则：？

申请与申请方？

注销：数据已上链，该操作要干些啥？只设置有效状态？

发布：新增完直接发布，还是申请完发布？

